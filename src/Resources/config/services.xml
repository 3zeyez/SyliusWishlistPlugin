<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services
               http://symfony.com/schema/dic/services/services-1.0.xsd">

    <imports>
        <import resource="services/**/*.xml"/>
    </imports>

    <services>
        <service id="bitbag_sylius_wishlist_plugin.controller.action.base_wishlist_products_action" abstract="true" class="BitBag\SyliusWishlistPlugin\Controller\Action\BaseWishlistProductsAction">
            <argument type="service" id="sylius.context.cart"/>
            <argument type="service" id="form.factory"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.processor.wishlist_command_processor"/>
            <argument type="service" id="sylius.command_bus"/>
            <argument type="service" id="router"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="translator"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.base_wishlists_listing_action" abstract="true" class="BitBag\SyliusWishlistPlugin\Controller\Action\BaseWishlistsListingAction">
            <argument type="service" id="twig"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.list_wishlists" class="BitBag\SyliusWishlistPlugin\Controller\Action\ListWishlistsAction" parent="bitbag_sylius_wishlist_plugin.controller.action.base_wishlists_listing_action">
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.render_header_template" class="BitBag\SyliusWishlistPlugin\Controller\Action\RenderHeaderTemplateAction" parent="bitbag_sylius_wishlist_plugin.controller.action.base_wishlists_listing_action">
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.add_product_to_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\AddProductToWishlistAction">
            <argument type="service" id="sylius.repository.product"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.factory.wishlist_product"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.manager.wishlist"/>
            <argument type="service" id="sylius.context.channel"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.remove_product_from_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\RemoveProductFromWishlistAction">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.context.wishlist"/>
            <argument type="service" id="sylius.repository.product"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.manager.wishlist_product"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="router"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.clean_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\CleanWishlistAction">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.manager.wishlist_product"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="router"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.add_product_variant_to_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\AddProductVariantToWishlistAction">
            <argument type="service" id="sylius.repository.product_variant"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.factory.wishlist_product"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="router"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.remove_product_variant_from_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\RemoveProductVariantFromWishlistAction">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="sylius.repository.product_variant"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.manager.wishlist_product"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="router"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.remove_selected_products_from_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\RemoveSelectedProductsFromWishlistAction" parent="bitbag_sylius_wishlist_plugin.controller.action.base_wishlist_products_action" public="true">
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.add_selected_products_to_cart" class="BitBag\SyliusWishlistPlugin\Controller\Action\AddSelectedProductsToCartAction" parent="bitbag_sylius_wishlist_plugin.controller.action.base_wishlist_products_action" public="true">
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.export_selected_products_to_csv" class="BitBag\SyliusWishlistPlugin\Controller\Action\ExportSelectedProductsToCsvAction">
            <argument type="service" id="sylius.context.cart.new_shop_based.inner"/>
            <argument type="service" id="form.factory"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.processor.wishlist_command_processor"/>
            <argument type="service" id="router"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="sylius.command_bus"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.import_from_csv" class="BitBag\SyliusWishlistPlugin\Controller\Action\ImportWishlistFromCsvAction">
            <argument type="service" id="form.factory"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="twig"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
            <argument type="service" id="sylius.command_bus"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.list_wishlist_products" class="BitBag\SyliusWishlistPlugin\Controller\Action\ListWishlistProductsAction">
            <argument type="service" id="sylius.context.cart"/>
            <argument type="service" id="form.factory"/>
            <argument type="service" id="twig"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.processor.wishlist_command_processor"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="router"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.add_products_to_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\AddProductsToCartAction" parent="bitbag_sylius_wishlist_plugin.controller.action.base_wishlist_products_action" public="true">
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.context.wishlist" class="BitBag\SyliusWishlistPlugin\Context\WishlistContext" public="true">
            <argument type="service" id="security.token_storage"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.factory.wishlist"/>
            <argument>%bitbag_sylius_wishlist_plugin.parameters.wishlist_cookie_token%</argument>
            <argument type="service" id="sylius.context.channel"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.token_user_resolver"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.custom_factory.wishlist" class="BitBag\SyliusWishlistPlugin\Factory\WishlistFactory" decorates="bitbag_sylius_wishlist_plugin.factory.wishlist" public="false">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.custom_factory.wishlist.inner"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.custom_factory.wishlist_product" class="BitBag\SyliusWishlistPlugin\Factory\WishlistProductFactory" decorates="bitbag_sylius_wishlist_plugin.factory.wishlist_product" public="false">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.custom_factory.wishlist_product.inner"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.custom_factory.csv_wishlist_product" class="BitBag\SyliusWishlistPlugin\Factory\CsvWishlistProductFactory"/>

        <service id="bitbag_sylius_wishlist_plugin.custom_factory.csv.serializer" class="BitBag\SyliusWishlistPlugin\Factory\CsvSerializerFactory"/>

        <service id="bitbag_sylius_wishlist_plugin.custom_factory.dom_pdf" class="BitBag\SyliusWishlistPlugin\Factory\DomPdfFactory">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.custom_factory.dom_pdf_options"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.custom_factory.dom_pdf_options" class="BitBag\SyliusWishlistPlugin\Factory\DomPdfOptionsFactory"/>

        <service id="bitbag_sylius_wishlist_plugin.event_listener.create_new_wishlist" class="BitBag\SyliusWishlistPlugin\EventSubscriber\CreateNewWishlistSubscriber">
            <argument>%bitbag_sylius_wishlist_plugin.parameters.wishlist_cookie_token%</argument>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlist_cookie_token_resolver"/>
            <argument type="service" id="request_stack"/>
            <tag name="kernel.event_subscriber" event="kernel.exception"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.event_subscriber.logged_user_wishlist_subscriber" class="BitBag\SyliusWishlistPlugin\EventSubscriber\LoggedUserWishlistSubscriber">
            <argument type="service" id="sylius.section_resolver.uri_based_section_resolver"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.manager.wishlist_product"/>
            <tag name="kernel.event_subscriber"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.form.type.add_products_to_cart" class="BitBag\SyliusWishlistPlugin\Form\Type\AddProductsToCartType">
            <argument type="service" id="sylius.factory.add_to_cart_command"/>
            <argument type="service" id="sylius.factory.order_item"/>
            <argument type="service" id="sylius.order_item_quantity_modifier"/>
            <argument>%sylius.form.type.cart_item.validation_groups%</argument>
            <tag name="form.type"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.form.type.extension.add_to_cart_type_extension" class="BitBag\SyliusWishlistPlugin\Form\Extension\AddToCartTypeExtension">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlists_resolver"/>
            <tag name="form.type_extension" extended_type="Sylius\Bundle\CoreBundle\Form\Type\Order\AddToCartType"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.export_wishlist_to_pdf_action" class="BitBag\SyliusWishlistPlugin\Controller\Action\ExportWishlistToPdfAction" parent="bitbag_sylius_wishlist_plugin.controller.action.base_wishlist_products_action" public="true">
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.resolver.variant_image_path_resolver" class="BitBag\SyliusWishlistPlugin\Resolver\VariantImageToDataUriResolver">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.generate_data_uri_for_image_resolver"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.resolver.generate_data_uri_for_image_resolver" class="BitBag\SyliusWishlistPlugin\Resolver\GenerateDataUriForImageResolver">
            <argument type="service" id="assets.empty_package"/>
            <argument type="service" id="liip_imagine.service.filter"/>
            <argument>sylius_shop_product_thumbnail</argument>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.services.generator.model_creator" class="BitBag\SyliusWishlistPlugin\Services\Generator\ModelCreator">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.variant_image_path_resolver"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.model.factory.variant_pdf_model_factory"/>
            <argument type="service" id="request_stack"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.model.factory.variant_pdf_model_factory" class="BitBag\SyliusWishlistPlugin\Model\Factory\VariantPdfModelFactory"/>

        <service id="bitbag_sylius_wishlist_plugin.services.exporter" class="BitBag\SyliusWishlistPlugin\Services\Exporter\WishlistToPdfExporter">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.processor.variant_pdf_model_processor"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.services.exporter.dom_pdf_wishlist_exporter"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.services.exporter.dom_pdf_wishlist_exporter" class="BitBag\SyliusWishlistPlugin\Services\Exporter\DomPdfWishlistExporter">
            <argument type="service" id="twig"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.custom_factory.dom_pdf"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.create_new_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\CreateNewWishlistAction">
            <argument type="service" id="sylius.command_bus"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="sylius.context.channel"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.form.type.create_new_wishlist" class="BitBag\SyliusWishlistPlugin\Form\Type\CreateNewWishlistType">
            <tag name="form.type"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.form.type.wishlist_collection_type" class="BitBag\SyliusWishlistPlugin\Form\Type\WishlistCollectionType">
            <argument type="service" id="translator"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.processor.selected_wishlist_products_processor"/>
            <tag name="form.type"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.show_chosen_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\ShowChosenWishlistAction">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="sylius.context.cart"/>
            <argument type="service" id="form.factory"/>
            <argument type="service" id="twig"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.processor.wishlist_command_processor"/>
            <argument type="service" id="router.default"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlist_cookie_token_resolver"/>
            <argument type="service" id="security.token_storage"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.token_user_resolver"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.add_product_to_selected_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\AddProductToSelectedWishlistAction">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="sylius.repository.product"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="router"/>
            <argument type="service" id="sylius.command_bus"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.copy_selected_products_to_other_wishlist" class="BitBag\SyliusWishlistPlugin\Controller\Action\CopySelectedProductsToOtherWishlistAction">
            <argument type="service" id="sylius.command_bus"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.twig.extension.wishlist_extension" class="BitBag\SyliusWishlistPlugin\Twig\WishlistExtension">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.wishlist_cookie_token_resolver"/>
            <tag name="twig.extension"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.services.duplicator" class="BitBag\SyliusWishlistPlugin\Duplicator\WishlistProductsToOtherWishlistDuplicator">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.facade.wishlist_product_factory_facade"/>
            <argument type="service" id="sylius.repository.product_variant"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.checker.wishlist_name_checker" class="BitBag\SyliusWishlistPlugin\Checker\WishlistNameChecker"/>

        <service id="bitbag_sylius_wishlist_plugin.services.product_quantity_checker" class="BitBag\SyliusWishlistPlugin\Checker\ProductQuantityChecker"/>

        <service id="bitbag_sylius_wishlist_plugin.services.product_processing_checker" class="BitBag\SyliusWishlistPlugin\Checker\ProductProcessingChecker">
            <argument type="service" id="bitbag_sylius_wishlist_plugin.services.product_quantity_checker"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.update_wishlist_name_action" class="BitBag\SyliusWishlistPlugin\Controller\Action\UpdateWishlistNameAction">
            <argument type="service" id="sylius.command_bus"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="router"/>
            <tag name="controller.service_arguments"/>
        </service>

        <service id="bitbag_sylius_wishlist_plugin.controller.action.add_wishlists_to_user" class="BitBag\SyliusWishlistPlugin\Controller\Action\AddWishlistToUserAction">
            <argument type="service" id="sylius.command_bus"/>
            <argument type="service" id="request_stack"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.repository.wishlist"/>
            <argument type="service" id="router"/>
            <argument type="service" id="security.token_storage"/>
            <argument type="service" id="bitbag_sylius_wishlist_plugin.resolver.token_user_resolver"/>
            <tag name="controller.service_arguments"/>
        </service>
    </services>
</container>
